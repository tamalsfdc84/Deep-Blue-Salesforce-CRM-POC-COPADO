<template>
  <article class="slds-card">
    <div class="slds-box">
      <div class="slds-box">
        <div class="slds-grid slds-gutters">
          <div class="slds-col">
            <div class="slds-form-element">
              <label class="slds-form-element__label" for="phoneNumber"> Phone Number </label>
              <div class="slds-form-element__control">
                <input type="text" id="phoneNumber" name="phoneNumber" placeholder="Phone Number" value={phoneNumber}
                  onchange={inputValueOnChange} class="slds-input" />
              </div>
            </div>
          </div>
          <div class="slds-col">
            <div class="slds-form-element">
              <label class="slds-form-element__label" for="firstName"> First Name </label>
              <div class="slds-form-element__control">
                <input type="text" id="firstName" name="firstName" placeholder="First Name" value={firstName}
                  onchange={inputValueOnChange} class="slds-input" />
              </div>
            </div>
          </div>
          <div class="slds-col">
            <div class="slds-form-element">
              <label class="slds-form-element__label" for="lastName"> Last Name </label>
              <div class="slds-form-element__control">
                <input type="text" id="lastName" name="lastName" placeholder="Last Name" value={lastName}
                  onchange={inputValueOnChange} class="slds-input" />
              </div>
            </div>
          </div>
          <div class="slds-col">
            <div class="slds-form-element">
              <label class="slds-form-element__label" for="ssn"> SSN </label>
              <div class="slds-form-element__control">
                <input type="text" id="ssn" name="ssn" placeholder="SSN" value={ssn} onchange={inputValueOnChange}
                  class="slds-input" />
              </div>
            </div>
          </div>
          <div class="slds-col">
            <div class="slds-form-element">
              <label class="slds-form-element__label" for="accountNumber"> Account Number </label>
              <div class="slds-form-element__control">
                <input type="text" id="accountNumber" name="accountNumber" placeholder="Account #" value={accountNumber}
                  onchange={inputValueOnChange} class="slds-input" />
              </div>
            </div>
          </div>
          <div class="slds-col search-padding">
            <lightning-button variant="brand" label="Search" title="Search" onclick={handleSearchButtonClick}
              class="slds-m-left_x-small"></lightning-button>
          </div>
        </div>
      </div>
      <!-- Container for main search results -->
      <div class="slds-grid slds-gutters slds-m-top_large">
        <div class="slds-col slds-size_1-of-2">
          <div class="slds-box main-search-min-height">
            <article class="slds-card">
              <div class="
                  slds-card__header
                  slds-grid
                  slds-p-bottom_medium
                  slds-border_bottom
                ">
                <header class="slds-media slds-media_center slds-has-flexi-truncate">
                  <lightning-icon icon-name="standard:account" alternative-text="Accounts" title="Accounts">
                  </lightning-icon>
                  <div class="slds-media__body slds-p-left_medium">
                    <h2 class="slds-card__header-title search-account-title">
                      <span>Accounts</span>
                    </h2>
                    <template if:true={shouldShowD3Changes}>
                      <template if:true={hasSelectedAccount}>
                        <div class="slds-float_right">
                          <lightning-button-group>
                            <lightning-button variant="brand" label="SMS Verification" title="SMS Verification" icon-name="utility:sms" 
                              class="slds-m-left_x-small" onclick={handleSmsVerificationClick}></lightning-button>
                            <lightning-button variant="brand" label="Email Verification" title="Email Verification" icon-name="utility:email" 
                              class="slds-m-left_x-small" onclick={handleEmailVerificationClick}></lightning-button>
                            <lightning-button variant="brand" label="Identity Verification" title="Identity Verification" icon-name="utility:questions_and_answers" 
                              class="slds-m-left_x-small" onclick={handlePenleyClick}></lightning-button>
                          </lightning-button-group>
                        </div>
                      </template>
                    </template>
                  </div>
                </header>
              </div>
              <div class="slds-card__body slds-card__body_inner slds-scrollable_y search-result-max-height">
                <template if:false={isLoadingSearchResult}>
                  <template if:true={searchHasNoResult}>
                    <p class="text-center">No search results found</p>
                  </template>
                  <template if:false={searchHasNoResult}>
                    <template for:each={listSearchResult} for:item="searchResult">
                      <div class="slds-box slds-m-bottom_small search-result-box" key={searchResult.AccountId}
                        data-item={searchResult.AccountId} onclick={handleSearchResultClick}>
                        <article class="slds-card search-result-box-article">
                          <div class="slds-card__header slds-grid">
                            <header class="
                            slds-media slds-media_center
                            slds-has-flexi-truncate
                          ">
                              <div class="slds-media__body">
                                <h2 class="slds-card__header-title">
                                  <lightning-icon icon-name="standard:person_account" alternative-text="Person Account"
                                    title="Person Account" size="small" class="slds-m-right_medium">
                                  </lightning-icon>
                                  <a href="#" class="slds-card__header-link slds-truncate" title={searchResult.Name}
                                    onclick={accountNameClicked} data-item={searchResult.AccountId}>
                                    <span class="account-name">{searchResult.Name}</span>
                                  </a>
                                </h2>
                              </div>
                            </header>
                          </div>
                          <div class="slds-card__body slds-card__body_inner">
                            <div class="slds-grid slds-gutters">
                              <div class="slds-col">
                                <div class="slds-tile__detail">
                                  <dl class="slds-list_horizontal slds-wrap">
                                    <dt class="
                                    slds-item_label
                                    slds-text-color_weak
                                    slds-truncate
                                  " title="Home Phone"> Home Phone: </dt>
                                    <dd class="slds-item_detail slds-truncate" title="">
                                      <lightning-formatted-phone value={searchResult.HomePhone} disabled>
                                      </lightning-formatted-phone>
                                    </dd>
                                    <dt class="
                                    slds-item_label
                                    slds-text-color_weak
                                    slds-truncate
                                  " title="Mobile Phone"> Mobile Phone: </dt>
                                    <dd class="slds-item_detail slds-truncate" title="">
                                      <lightning-formatted-phone value={searchResult.MobilePhone} disabled>
                                      </lightning-formatted-phone>
                                    </dd>
                                    <dt class="
                                    slds-item_label
                                    slds-text-color_weak
                                    slds-truncate
                                  " title="Business Phone"> Business Phone: </dt>
                                    <dd class="slds-item_detail slds-truncate" title="">
                                      <lightning-formatted-phone value={searchResult.BusinessPhone} disabled>
                                      </lightning-formatted-phone>
                                    </dd>
                                    <dt class="
                                    slds-item_label
                                    slds-text-color_weak
                                    slds-truncate
                                  " title="Other Phone"> Other Phone: </dt>
                                    <dd class="slds-item_detail slds-truncate" title="">
                                      <lightning-formatted-phone value={searchResult.OtherPhone} disabled>
                                      </lightning-formatted-phone>
                                    </dd>
                                    <dt class="
                                    slds-item_label
                                    slds-text-color_weak
                                    slds-truncate
                                  " title="Assistant Phone"> Assistant Phone: </dt>
                                    <dd class="slds-item_detail slds-truncate" title="">
                                      <lightning-formatted-phone value={searchResult.AssistantPhone} disabled>
                                      </lightning-formatted-phone>
                                    </dd>
                                    <dt class="
                                    slds-item_label
                                    slds-text-color_weak
                                    slds-truncate
                                  " title="Driver's License"> Driver's License: </dt>
                                    <template if:false={searchResult.HasReturnedMulesoftResult}>
                                      <dd class="slds-item_detail slds-truncate" title="">
                                        <i class="c-inline-spinner"></i>
                                      </dd>
                                    </template>
                                    <template if:true={searchResult.HasReturnedMulesoftResult}>
                                      <dd class="slds-item_detail slds-truncate" title=""> {searchResult.DriversLicense}
                                      </dd>
                                    </template>
                                  </dl>
                                </div>
                              </div>
                              <div class="slds-col">
                                <div class="slds-tile__detail">
                                  <dl class="slds-list_horizontal slds-wrap">
                                    <dt class="
                                    slds-item_label
                                    slds-text-color_weak
                                    slds-truncate
                                  " title="Date of Birth"> Date of Birth: </dt>
                                    <dd class="slds-item_detail slds-truncate" title={searchResult.Name}>
                                      {searchResult.DateOfBirth} </dd>
                                    <dt class="
                                    slds-item_label
                                    slds-text-color_weak
                                    slds-truncate
                                  " title="Last 4 of Social"> Last 4 of Social: </dt>
                                    <dd class="slds-item_detail slds-truncate" title=""> {searchResult.Last4OfSocial}
                                    </dd>
                                    <dt class="
                                    slds-item_label
                                    slds-text-color_weak
                                    slds-truncate
                                  " title="Email"> Email: </dt>
                                    <dd class="slds-item_detail slds-truncate" title=""> {searchResult.Email} </dd>
                                    <dt class="
                                    slds-item_label
                                    slds-text-color_weak
                                    slds-truncate
                                  " title="Mother's Maiden Name"> Mother's Maiden Name: </dt>
                                    <dd class="slds-item_detail slds-truncate" title="">
                                      {searchResult.MothersMaidenName} </dd>
                                    <dt class="
                                    slds-item_label
                                    slds-text-color_weak
                                    slds-truncate
                                  " title="Last 8 of Debit Card"> Last 8 of Debit Card: </dt>
                                    <dd class="slds-item_detail slds-truncate" title=""> {searchResult.Last8OfDebitCard}
                                    </dd>
                                  </dl>
                                </div>
                              </div>
                            </div>
                            <div>
                              <!-- Password section goes here -->
                              <div class="slds-grid slds-wrap password-table">
                                <div class="slds-col slds-size_1-of-2 password-table-cell"> Password Clue </div>
                                <div class="slds-col slds-size_1-of-2"> Password Answer </div>
                              </div>
                              <template if:false={searchResult.HasReturnedMulesoftResult}>
                                <div class="slds-grid slds-wrap password-table-cell-wrapper">
                                  <div class="slds-col slds-size_1-of-2 password-table-cell"> <i
                                      class="c-inline-spinner"></i> </div>
                                  <div class="slds-col slds-size_1-of-2"> <i class="c-inline-spinner"></i> </div>
                                </div>
                              </template>                             
                              <template if:true={searchResult.HasReturnedMulesoftResult}>
                                <template if:true={searchResult.HasOneOrMorePasswordResult}>
                                  <template for:each={searchResult.ListPassword} for:item="passwordResult">
                                    <!--Added password-table-cell-highlight as per SGE-87-->
                                    <div class="slds-grid slds-wrap password-table-cell-wrapper password-table-cell-highlight" 
                                      key={passwordResult.RecordCount}>
                                      <div class="slds-col slds-size_1-of-2 password-table-cell">
                                        {passwordResult.PasswordQuestion} </div>
                                      <div class="slds-col slds-size_1-of-2"> {passwordResult.PasswordAnswer} </div>
                                    </div>
                                  </template>
                                </template>
                                <template if:false={searchResult.HasOneOrMorePasswordResult}>
                                  <div class="slds-grid slds-wrap password-table-cell-wrapper">
                                    <div class="slds-col slds-size_1-of-2 password-table-cell"> --- </div>
                                    <div class="slds-col slds-size_1-of-2"> --- </div>
                                  </div>
                                </template>
                              </template>
                            </div>
                          </div>
                        </article>
                      </div>
                    </template>
                  </template>
                </template>
                <template if:true={isLoadingSearchResult}>
                  <div class="loader"></div>
                </template>
              </div>
            </article>
          </div>
        </div>
        <div class="slds-col slds-size_1-of-2">
          <div class="slds-grid slds-grid_vertical right-panel-margin">
            <div class="slds-col slds-m-bottom_small">
              <div class="slds-box sub-search-min-height">
                <article class="slds-card">
                  <div class="
                      slds-card__header
                      slds-grid
                      slds-p-bottom_medium
                      slds-border_bottom
                    ">
                    <header class="
                        slds-media slds-media_center
                        slds-has-flexi-truncate
                      ">
                      <lightning-icon icon-name="custom:custom16" alternative-text="Financial Accounts"
                        title="Financial Accounts"></lightning-icon>
                      <div class="slds-media__body slds-p-left_medium">
                        <h2 class="slds-card__header-title">
                          <span>Financial Accounts</span>
                        </h2>
                      </div>
                    </header>
                  </div>
                  <div class="
                      slds-card__body slds-card__body_inner
                      slds-scrollable_y  
                      right-panel-max-height                    
                    ">
                    <template if:true={hasListFinancialAccount}>
                      <lightning-datatable hide-checkbox-column key-field="FinancialAccountId"
                        data={listFinancialAccount} columns={financialAccountColumns}>
                      </lightning-datatable>
                    </template>
                    <template if:true={isLoadingAdditionalSearchResult}>
                      <div class="loader financial-account-loader"></div>
                    </template>
                  </div>
                </article>
              </div>
            </div>
            <!-- <div class="slds-col slds-m-bottom_small">
              <div class="slds-box sub-search-min-height">
                <article class="slds-card">
                  <div class="
                      slds-card__header
                      slds-grid
                      slds-p-bottom_medium
                      slds-border_bottom
                    ">
                    <header class="
                        slds-media slds-media_center
                        slds-has-flexi-truncate
                      ">
                      <lightning-icon icon-name="standard:product_transfer" alternative-text="Recent Transactions" title="Recent Transactions">
                      </lightning-icon>
                      <div class="slds-media__body slds-p-left_medium">
                        <h2 class="slds-card__header-title">
                          <span>Recent Transactions</span>
                        </h2>
                      </div>
                    </header>
                  </div>  
                  <div class="
                      slds-card__body slds-card__body_inner
                      slds-scrollable_y  
                      right-panel-max-height                    
                    ">
                    <template if:true={hasListRecentTransaction}>
                      <lightning-datatable hide-checkbox-column key-field="RecordKey"
                        data={listRecentTransaction} columns={recentTransactionColumns}>
                      </lightning-datatable>
                    </template>
                    <template if:true={isLoadingAdditionalSearchResult}>
                      <div class="loader financial-account-loader"></div>
                    </template>
                  </div>                
                </article>
              </div>
            </div> -->
            <div class="slds-col">
              <div class="slds-box">
                <article class="slds-card">
                  <div class="
                      slds-card__header
                      slds-grid
                    ">
                    <header class="
                        slds-media slds-media_center
                        slds-has-flexi-truncate
                      ">
                      <lightning-icon icon-name="standard:home" alternative-text="Current Residence" title="Current Residence">
                      </lightning-icon>
                      <div class="slds-p-left_medium">
                        <h2 class="slds-card__header-title">
                          <span>Current Residence: </span>
                        </h2>
                      </div>
                      <template if:true={currentResidence}>
                        <p class="slds-p-left_small">{currentResidence.Street}, {currentResidence.City}, {currentResidence.State} {currentResidence.Zip} {currentResidence.Country}</p>
                      </template>
                    </header>
                  </div>                  
                </article>
              </div>
            </div>
          </div>
        </div>
      </div>
      <template if:true={showShowModal}>
        <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="verification" class="slds-modal slds-fade-in-open">
          <div class="slds-modal__container">
            <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" onclick={closeModalClicked}>
              <lightning-icon icon-name="utility:close" alternative-text="Cancel and close" title="Cancel and close"
              variant="inverse"></lightning-icon>
              <span class="slds-assistive-text">Cancel and close</span>
            </button>
            <div class="slds-modal__header">
            <h1 id="verification" class="slds-modal__title slds-hyphenate">{modalTitle}</h1>
            </div>
            <div class="slds-modal__content slds-p-around_medium modal-min-height" id="verificationContent">
                <template if:true={shouldShowLegalText}>
                  <template if:true={isGoingThroughEmailVerification}>
                    <p class="big-font">{customerFirstName},</p>
                    <p class="big-font">{label.emailScriptLine1}</p><br/>
                    <lightning-radio-group name="radioGroup"
                           label="Has Customer approved Wintrust to send a One Time Passcode?"
                           options={smsYesNoOptions}
                           value={smsYesNoValue}
                           onchange={handleApprovalCheckBoxChange}
                           required
                           type="button"></lightning-radio-group>
                    <template if:true={hasAnsweredLegalText}>
                      <template if:false={hasCustomerApproval}>
                        <div class="slds-m-top_xx-large"></div>
                        <p class="big-font">{label.emailScriptLine4}</p>
                      </template>
                    </template>
                  </template>
                  <template if:true={isGoingThroughSmsVerification}>
                    <p class="big-font">{customerFirstName},</p>
                    <p class="big-font">{label.smsScriptLine1}</p><br/>
                    <lightning-radio-group name="radioGroup"
                           label="Has Customer approved Wintrust to send a One Time Passcode?"
                           options={smsYesNoOptions}
                           value={smsYesNoValue}
                           onchange={handleApprovalCheckBoxChange}
                           required
                           type="button"></lightning-radio-group>
                    <template if:true={hasAnsweredLegalText}>
                      <template if:false={hasCustomerApproval}>
                        <div class="slds-m-top_xx-large"></div>
                        <p class="big-font">{label.smsScriptLine4}</p>
                      </template>
                    </template>
                  </template>                  
                </template>
                <template if:false={shouldShowLegalText}>
                  <template if:true={isGoingThroughSmsVerification}>
                    <p>Choose the phone number to send the verification code to:</p>
                    <div class="slds-m-top_xx-large"></div>
                    <lightning-combobox
                      name="phoneNumberSelect"
                      label="Select a Phone Number"
                      value={selectedPhone}
                      placeholder="Select a Phone Number"
                      options={phoneNumberOptions}
                      onchange={handlePhoneNumberChange} ></lightning-combobox>
                    <template if:true={hasSelectedPhone}>
                      <div class="slds-m-top_medium"></div>
                      <div class="slds-align_absolute-center">
                        <template if:false={shouldDisableSendCodeButton}>
                          <lightning-button variant="brand-outline" label="Send Verification Code" 
                          title="Send Verification Code" onclick={handleSendVerificationCodeClick}></lightning-button>
                        </template>                      
                        <template if:true={shouldDisableSendCodeButton}>
                          <lightning-button variant="success" label="Send Verification Code" title="Send Verification Code" icon-name="utility:check" 
                          icon-position="right" class="slds-m-left_x-small" disabled></lightning-button>
                          <template if:true={isSendingCode}>
                            <lightning-spinner alternative-text="Loading" class="send-code-loading" size="small"></lightning-spinner>
                          </template>
                        </template>
                      </div>
                    </template>
                    <template if:true={isAccountLockedOut}>
                      <div class="slds-box slds-theme_error slds-m-top_large">
                        <div class="locked-icon">
                          <lightning-icon icon-name="utility:error" variant="inverse" size="x-small" alternative-text="Account Locked" title="Account Locked"></lightning-icon>
                        </div>
                        <div class="locked-message">
                          <p class="verification-message">{verificationLockedMessage}</p>
                        </div>
                      </div>
                    </template>
                    <template if:true={hasClickedSendVerificationCode}>
                      <div class="slds-m-top_large slds-p-around_none slds-m-bottom_medium slds-m-horizontal_none">
                        <lightning-layout>
                            <lightning-layout-item>
                                <div class="slds-text-align_center">
                                  <lightning-input type="text" variant="label-hidden" placeholder="Enter Verification Code"
                                  value={customerReadVerificationCode} onchange={handleVerificationCodeChange}></lightning-input>
                                </div>
                            </lightning-layout-item>
                            <lightning-layout-item>
                                <div class="slds-text-align_center">
                                  <template if:true={isVerifyingCode}>
                                    <lightning-spinner alternative-text="Loading" class="verify-loading" size="small"></lightning-spinner>
                                  </template>
                                  <template if:false={isVerifyingCode}>
                                    <lightning-button variant="brand-outline" label="Verify Code" title="Verify Code" onclick={handleVerifyCodeClick} class="slds-m-left_x-small"></lightning-button>
                                  </template>
                                </div>
                            </lightning-layout-item>
                        </lightning-layout>
                      </div>
                      <template if:true={shouldShowCustomerVerificationStatus}>
                        <div class="slds-m-top_large"></div>
                        <template if:true={isCustomerVerified}>
                          <div class="slds-box slds-theme_success">
                            <lightning-icon icon-name="utility:success" variant="inverse" alternative-text="Verified" title="Verified"></lightning-icon>
                            <p class="verification-message">Customer has been verified.</p>
                          </div>
                        </template>
                        <template if:false={isCustomerVerified}>
                          <template if:false={isVerifyAccountLockedOut}>
                            <div class="slds-box slds-theme_error">
                              <lightning-icon icon-name="utility:error" variant="inverse" alternative-text="Not Verified" title="Not Verified"></lightning-icon>
                              <p class="verification-message">Verification Code did not match.</p>
                            </div>
                          </template>
                          <template if:true={isVerifyAccountLockedOut}>
                            <div class="slds-box slds-theme_error slds-m-top_large">
                              <div class="locked-icon">
                                <lightning-icon icon-name="utility:error" variant="inverse" size="x-small" alternative-text="Account Locked" title="Account Locked"></lightning-icon>
                              </div>
                              <div class="locked-message">
                                <p class="verification-message">{verificationLockedMessage}</p>
                              </div>
                            </div>
                          </template>
                        </template>
                      </template>
                    </template>
                  </template>
                  <template if:true={isGoingThroughEmailVerification}>
                    <p>Choose the email address to send the verification code to:</p>
                    <div class="slds-m-top_xx-large"></div>
                    <lightning-combobox
                      name="emailSelect"
                      label="Select an Email"
                      value={selectedEmail}
                      placeholder="Select an Email"
                      options={emailOptions}
                      onchange={handleEmailChange} ></lightning-combobox>
                    <template if:true={hasSelectedEmail}>
                      <div class="slds-m-top_medium"></div>
                      <div class="slds-align_absolute-center">
                        <template if:false={shouldDisableSendCodeButton}>
                          <lightning-button variant="brand-outline" label="Send Verification Code" 
                          title="Send Verification Code" onclick={handleSendVerificationCodeClick}></lightning-button>
                        </template>                      
                        <template if:true={shouldDisableSendCodeButton}>                        
                          <lightning-button variant="success" label="Send Verification Code" title="Send Verification Code" icon-name="utility:check" 
                          icon-position="right" class="slds-m-left_x-small" disabled></lightning-button>
                          <template if:true={isSendingCode}>
                            <lightning-spinner alternative-text="Loading" class="verify-loading" size="small"></lightning-spinner>
                          </template>
                        </template>
                      </div>
                    </template>
                    <template if:true={isAccountLockedOut}>
                      <div class="slds-box slds-theme_error slds-m-top_large">
                        <div class="locked-icon">
                          <lightning-icon icon-name="utility:error" variant="inverse" size="x-small" alternative-text="Account Locked" title="Account Locked"></lightning-icon>
                        </div>
                        <div class="locked-message">
                          <p class="verification-message">{verificationLockedMessage}</p>
                        </div>
                      </div>
                    </template>
                    <template if:true={hasClickedSendVerificationCode}>
                      <div class="slds-m-top_large slds-p-around_none slds-m-bottom_medium slds-m-horizontal_none">
                        <lightning-layout>
                            <lightning-layout-item>
                                <div class="slds-text-align_center">
                                  <lightning-input type="text" variant="label-hidden" placeholder="Enter Verification Code"
                                  value={customerReadVerificationCode} onchange={handleVerificationCodeChange}></lightning-input>
                                </div>
                            </lightning-layout-item>
                            <lightning-layout-item>
                                <div class="slds-text-align_center">
                                  <template if:true={isVerifyingCode}>
                                    <lightning-spinner alternative-text="Loading" class="verify-loading" size="small"></lightning-spinner>
                                  </template>
                                  <template if:false={isVerifyingCode}>
                                    <lightning-button variant="brand-outline" label="Verify Code" title="Verify Code" onclick={handleVerifyCodeClick} class="slds-m-left_x-small"></lightning-button>
                                  </template>                                
                                </div>
                            </lightning-layout-item>
                        </lightning-layout>
                      </div>
                      <template if:true={shouldShowCustomerVerificationStatus}>
                        <div class="slds-m-top_large"></div>
                        <template if:true={isCustomerVerified}>
                          <div class="slds-box slds-theme_success">
                            <lightning-icon icon-name="utility:success" variant="inverse" alternative-text="Verified" title="Verified"></lightning-icon>
                            <p class="verification-message">Customer has been verified.</p>
                          </div>
                        </template>
                        <template if:false={isCustomerVerified}>
                          <template if:false={isVerifyAccountLockedOut}>
                            <div class="slds-box slds-theme_error">
                              <lightning-icon icon-name="utility:error" variant="inverse" alternative-text="Not Verified" title="Not Verified"></lightning-icon>
                              <p class="verification-message">Verification Code did not match.</p>
                            </div>
                          </template>
                          <template if:true={isVerifyAccountLockedOut}>
                            <div class="slds-box slds-theme_error slds-m-top_large">
                              <div class="locked-icon">
                                <lightning-icon icon-name="utility:error" variant="inverse" size="x-small" alternative-text="Account Locked" title="Account Locked"></lightning-icon>
                              </div>
                              <div class="locked-message">
                                <p class="verification-message">{verificationLockedMessage}</p>
                              </div>
                            </div>
                          </template>
                        </template>
                      </template>
                    </template>
                  </template>                
                </template>              
            </div>
            <div class="slds-modal__footer">
              <template if:true={shouldShowLegalText}>
                <button class="slds-button slds-button_neutral slds-float_left" onclick={closeModalClicked}>Close</button>
                <template if:false={hasCustomerApproval}>
                  <button class="slds-button slds-button_brand slds-float_right" disabled="">Next</button>
                </template>
                <template if:true={hasCustomerApproval}>
                  <button class="slds-button slds-button_brand slds-float_right" onclick={moveToNextScreenFromLegalClicked}>Next</button>
                </template>
              </template>              
              <template if:false={shouldShowLegalText}>
                <button class="slds-button slds-button_brand slds-float_right" onclick={closeModalClicked}>Finish</button>
              </template> 
            </div>
          </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>        
      </template>
      <template if:true={showShowIdentityVerificationModal}>
        <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="identityVerificationHeader" class="slds-modal slds-fade-in-open slds-modal_small">
          <div class="slds-modal__container">
            <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" onclick={closeModalClicked}>
              <lightning-icon icon-name="utility:close" alternative-text="Cancel and close" title="Cancel and close"
              variant="inverse"></lightning-icon>
              <span class="slds-assistive-text">Cancel and close</span>
            </button>
            <div class="slds-modal__header">
            <h1 id="identityVerificationHeader" class="slds-modal__title slds-hyphenate">{identityVerificationModalTitle}</h1>
            </div>
            <div class="slds-modal__content slds-p-around_medium identity-modal-min-height" id="identityVerificationContent">
              <template if:false={isLoadingIdaQuestions}>
                <template if:true={shouldShowIdentityVerificationLegalText}>
                  <p class="big-font">{customerFirstName},</p>
                  <p class="big-font">{label.penleyScriptLine1}</p><br/>
                  <div class="slds-m-top_xx-large"></div>

                  <template if:true={isIdentityQuestionErroredOut}>
                    <div class="slds-box slds-theme_error slds-m-top_large">
                      <div class="locked-icon">
                        <lightning-icon icon-name="utility:error" variant="inverse" size="x-small" alternative-text="Account Locked" title="Account Locked"></lightning-icon>
                      </div>
                      <div class="locked-message">
                        <p class="verification-message">{identityQuestionErrorMessage}</p>
                      </div>
                    </div>
                  </template>
                </template>
                <template if:false={shouldShowIdentityVerificationLegalText}>
                  <template if:true={currentQuestionObject}>
                    <lightning-radio-group
                      label={currentQuestionObject.QuestionText}
                      options={currentQuestionObject.ListAnswer}
                      value={currentQuestionObject.AnswerId}
                      onchange={handleIdentityVerificationAnswerChange}
                      class="ida_radio-group slds-text-heading_small"
                      type="radio">
                    </lightning-radio-group>
                  </template>
                  <template if:true={shouldShowVerifyIdentityButton}>
                    <lightning-layout>
                      <lightning-layout-item class="full-width">
                          <div class="slds-text-align_center slds-m-top_x-large">
                            <template if:true={isVerifyingCustomerIdentity}>
                              <lightning-spinner alternative-text="Loading" class="verify-loading" size="small"></lightning-spinner>
                            </template>
                            <template if:false={isVerifyingCustomerIdentity}>
                              <template if:false={shouldEnableShowVerifyIdentityButton}>
                                <lightning-button variant="brand-outline" label="Verify Customer Identity" title="Verify Customer Identity"
                                 class="slds-m-left_x-small" disabled=""></lightning-button>
                              </template>
                              <template if:true={shouldEnableShowVerifyIdentityButton}>
                                <lightning-button variant="brand-outline" label="Verify Customer Identity" title="Verify Customer Identity"
                                onclick={handleVerifyCustomerIdentityClick} class="slds-m-left_x-small"></lightning-button>
                              </template>                              
                            </template>                                
                          </div>
                      </lightning-layout-item>
                    </lightning-layout>
                  </template>
                  <template if:true={shouldShowCustomerIdentityVerificationStatus}>
                    <div class="slds-m-top_large"></div>
                    <template if:true={isCustomerIdentityVerified}>
                      <div class="slds-box slds-theme_success">
                        <lightning-icon icon-name="utility:success" variant="inverse" alternative-text="Verified" title="Verified"></lightning-icon>
                        <p class="verification-message">{identityVerificationMessage}</p>
                      </div>
                    </template>
                    <template if:false={isCustomerIdentityVerified}>
                      <template if:true={isIdentityVerifyAccountLockedOut}>
                        <div class="slds-box slds-theme_error slds-m-top_large">
                          <div class="locked-icon">
                          <lightning-icon icon-name="utility:error" variant="inverse" size="x-small" alternative-text="Account Locked" title="Account Locked"></lightning-icon>
                          </div>
                          <div class="locked-message">
                          <p class="verification-message">{identityVerificationMessage}</p>
                          </div>
                        </div>
                      </template>
                      <template if:false={isIdentityVerifyAccountLockedOut}>
                        <div class="slds-box slds-theme_error">
                          <lightning-icon icon-name="utility:error" variant="inverse" alternative-text="Not Verified" title="Not Verified"></lightning-icon>
                          <p class="verification-message">{identityVerificationMessage}</p>
                        </div>
                      </template>                      
                    </template>
                  </template>
                </template>
              </template>
              <template if:true={isLoadingIdaQuestions}>
                <template if:true={shouldShowIdentityVerificationLegalText}>
                  <p class="big-font">{customerFirstName},</p>
                  <p class="big-font">{label.penleyScriptLine1}</p><br/>
                  <div class="slds-m-top_xx-large"></div>
                </template>
                <lightning-spinner alternative-text="Loading" class="verify-loading slds-align_absolute-center" size="small"></lightning-spinner>
              </template>
            </div>
            <div class="slds-modal__footer">
              <template if:true={shouldShowPreviousButtonOnIdentityVerification}>
                <button class="slds-button slds-button_neutral slds-float_left" onclick={moveToPreviousScreenForPreviousQuestionClicked}>Previous</button>
              </template>      
              <template if:true={hasMoreQuestionsToAsk}>
                <template if:true={shouldEnableNextQuestionButton}>
                  <button class="slds-button slds-button_brand slds-float_right" onclick={moveToNextScreenForNextQuestionClicked}>Next</button>
                </template>
                <template if:false={shouldEnableNextQuestionButton}>
                  <button class="slds-button slds-button_brand slds-float_right" disabled>Next</button>
                </template>
              </template>
              <template if:false={hasMoreQuestionsToAsk}>
                <template if:false={isLoadingIdaQuestions}>
                  <button class="slds-button slds-button_brand slds-float_right" onclick={closeModalClicked}>Finish</button>
                </template>
              </template> 
            </div>
          </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>        
      </template>
    </div>
  </article>
</template>